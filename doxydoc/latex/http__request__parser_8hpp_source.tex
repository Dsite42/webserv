\doxysection{http\+\_\+request\+\_\+parser.\+hpp}
\hypertarget{http__request__parser_8hpp_source}{}\label{http__request__parser_8hpp_source}\index{source/http\_request\_parser.hpp@{source/http\_request\_parser.hpp}}
\mbox{\hyperlink{http__request__parser_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ HTTP\_REQUEST\_PARSER\_hpp}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ HTTP\_REQUEST\_PARSER\_hpp}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{config_8hpp}{config.hpp}}"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{http__request_8hpp}{http\_request.hpp}}"{}}}
\DoxyCodeLine{00006\ }
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <stdexcept>}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#define\ HTTP\_REQUEST\_HEADER\_MAX\_LENGTH\ 8192}}
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#define\ HTTP\_REQUEST\_BODY\_CHUNKED\_HEADER\_MAX\_LENGTH\ 256}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1}{HttpRequestPhase}}}
\DoxyCodeLine{00013\ \{}
\DoxyCodeLine{00014\ \ \ \ \ \textcolor{comment}{//\ In-\/progress\ phases}}
\DoxyCodeLine{00015\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1a6abc76af1430d69f92eb38212dda298b}{HTTP\_REQUEST\_HEADER}},}
\DoxyCodeLine{00016\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1ac19223148826639082b056187dbd681a}{HTTP\_REQUEST\_BODY\_RAW}},}
\DoxyCodeLine{00017\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1ad4a52564b6ba8219b9d406c56fea9eec}{HTTP\_REQUEST\_BODY\_CHUNKED\_HEADER}},}
\DoxyCodeLine{00018\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1a2379c14a0b420d6410e0fae242d4a999}{HTTP\_REQUEST\_BODY\_CHUNKED\_BODY}},}
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1aaae4f8cd099c9ed7775f5d2d52c17e8a}{HTTP\_REQUEST\_BODY\_CHUNKED\_CR}},}
\DoxyCodeLine{00020\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1a38e6c0ed2149a9c348f2710b3efa405f}{HTTP\_REQUEST\_BODY\_CHUNKED\_LF}},}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{comment}{//\ Final\ phases}}
\DoxyCodeLine{00023\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1aa20d49a693d85e6f2b67a8ca86e0fdd2}{HTTP\_REQUEST\_HEADER\_EXCEED}},}
\DoxyCodeLine{00024\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1a61674efe5774f477a63c1f52be0a62f1}{HTTP\_REQUEST\_BODY\_EXCEED}},}
\DoxyCodeLine{00025\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1a4f0310ce7444991958a4bc4a5d6c6b6c}{HTTP\_REQUEST\_MALFORMED}},}
\DoxyCodeLine{00026\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1a31e7e82a72529018542f20ac22ed9c42}{HTTP\_REQUEST\_COMPLETED}}}
\DoxyCodeLine{00027\ \};}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classHttpRequestParser}{HttpRequestParser}}}
\DoxyCodeLine{00030\ \{}
\DoxyCodeLine{00031\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00032\ \ \ \ \ \textcolor{comment}{/*\ Constructs\ a\ HTTP\ request\ parser\ using\ the\ given\ rules\ */}}
\DoxyCodeLine{00033\ \ \ \ \ \mbox{\hyperlink{classHttpRequestParser_a31ec3df70f81ae1417d5c18d9ee04428}{HttpRequestParser}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structServerConfig}{ServerConfig}}\ \&config,\ uint32\_t\ host,\ uint16\_t\ port);}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ \ \ \textcolor{comment}{/*\ Prepares\ the\ parser\ to\ consume\ the\ next\ request\ */}}
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHttpRequestParser_a457e957050c52f4962dfca96968fb654}{reset}}();}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \textcolor{comment}{/*\ Commits\ data\ to\ the\ parser,\ returns\ whether\ the\ parser\ has\ transitioned\ into\ a\ final\ phase\ */}}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classHttpRequestParser_ace596a1d7eb3c74e884941b9b50fbd64}{commit}}(\mbox{\hyperlink{classSlice}{Slice}}\ \&data);}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \ \ \textcolor{comment}{/*\ Gets\ the\ parser's\ current\ phase\ */}}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1}{HttpRequestPhase}}\ \mbox{\hyperlink{classHttpRequestParser_aa0081bca641c4d8364cbdd2e3661021c}{getPhase}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00043\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_phase;}
\DoxyCodeLine{00045\ \ \ \ \ \}}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{comment}{/*\ Gets\ the\ built\ request;\ only\ valid\ when\ the\ current\ phase\ is\ \`{}HTTP\_REQUEST\_COMPLETED`\ */}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structHttpRequest}{HttpRequest}}\ \&\mbox{\hyperlink{classHttpRequestParser_ab5bb209bd9ab9e44678ff2aff76413f8}{getRequest}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00049\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\_phase\ !=\ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1a31e7e82a72529018542f20ac22ed9c42}{HTTP\_REQUEST\_COMPLETED}})}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{throw}\ std::runtime\_error(\textcolor{stringliteral}{"{}Attempt\ to\ access\ incomplete\ or\ malformed\ request"{}});}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_request;}
\DoxyCodeLine{00053\ \ \ \ \ \}}
\DoxyCodeLine{00054\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{structServerConfig}{ServerConfig}}\ \&\_config;}
\DoxyCodeLine{00056\ \ \ \ \ uint32\_t\ \ \ \ \ \ \ \ \ \ \ \ \_host;}
\DoxyCodeLine{00057\ \ \ \ \ uint16\_t\ \ \ \ \ \ \ \ \ \ \ \ \_port;}
\DoxyCodeLine{00058\ \ \ \ \ \mbox{\hyperlink{structHttpRequest}{HttpRequest}}\ \ \ \ \ \ \ \ \ \_request;}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1}{HttpRequestPhase}}\ \ \ \ \_phase;}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordtype}{char}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_headerBuffer[\mbox{\hyperlink{http__request__parser_8hpp_ad40c24d64a8fc4112910aed53aad21fe}{HTTP\_REQUEST\_HEADER\_MAX\_LENGTH}}];}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_headerLength;}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_bodyRemainder;}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{char}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_chunkHeaderBuffer[\mbox{\hyperlink{http__request__parser_8hpp_a42213932fb451f90e97de3d5f6d2a4d0}{HTTP\_REQUEST\_BODY\_CHUNKED\_HEADER\_MAX\_LENGTH}}];}
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_chunkHeaderLength;}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordtype}{bool}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_isEndChunk;}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{/*\ Handles\ a\ data\ commit\ in\ the\ \`{}HTTP\_REQUEST\_HEADER`\ phase\ */}}
\DoxyCodeLine{00068\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1}{HttpRequestPhase}}\ handleHeader(\mbox{\hyperlink{classSlice}{Slice}}\ \&data);}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{comment}{/*\ Handles\ a\ data\ commit\ in\ the\ \`{}HTTP\_REQUEST\_BODY\_RAW`\ phase\ */}}
\DoxyCodeLine{00071\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1}{HttpRequestPhase}}\ handleBodyRaw(\mbox{\hyperlink{classSlice}{Slice}}\ \&data);}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{comment}{/*\ Handles\ a\ data\ commit\ in\ the\ \`{}HTTP\_REQUEST\_BODY\_CHUNKED\_HEADER`\ phase\ */}}
\DoxyCodeLine{00074\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1}{HttpRequestPhase}}\ handleBodyChunkedHeader(\mbox{\hyperlink{classSlice}{Slice}}\ \&data);}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \ \ \textcolor{comment}{/*\ Handles\ a\ data\ commit\ in\ the\ \`{}HTTP\_REQUEST\_BODY\_CHUNKED\_BODY`\ phase\ */}}
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1}{HttpRequestPhase}}\ handleBodyChunkedBody(\mbox{\hyperlink{classSlice}{Slice}}\ \&data);}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00079\ \ \ \ \ \textcolor{comment}{/*\ Handles\ a\ data\ commit\ in\ the\ \`{}HTTP\_REQUEST\_BODY\_CHUNKED\_CR`\ phase\ */}}
\DoxyCodeLine{00080\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1}{HttpRequestPhase}}\ handleBodyChunkedCR(\mbox{\hyperlink{classSlice}{Slice}}\ \&data);}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \ \ \textcolor{comment}{/*\ Handles\ a\ data\ commit\ in\ the\ \`{}HTTP\_REQUEST\_BODY\_CHUNKED\_LF`\ phase\ */}}
\DoxyCodeLine{00083\ \ \ \ \ \mbox{\hyperlink{http__request__parser_8hpp_a234347af42fceae45cbd712101670ea1}{HttpRequestPhase}}\ handleBodyChunkedLF(\mbox{\hyperlink{classSlice}{Slice}}\ \&data);}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{comment}{/*\ Parses\ the\ given\ HTTP\ header\ */}}
\DoxyCodeLine{00086\ \ \ \ \ \textcolor{keywordtype}{bool}\ parseHeader(\mbox{\hyperlink{classSlice}{Slice}}\ data);}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{comment}{/*\ Parses\ the\ given\ HTTP\ chunk\ header\ */}}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{keywordtype}{bool}\ parseChunkHeader(\mbox{\hyperlink{classSlice}{Slice}}\ data);}
\DoxyCodeLine{00090\ \};}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ HTTP\_REQUEST\_PARSER\_hpp}}

\end{DoxyCode}
