\doxysection{http\+\_\+response.\+hpp}
\hypertarget{http__response_8hpp_source}{}\label{http__response_8hpp_source}\index{source/http\_response.hpp@{source/http\_response.hpp}}
\mbox{\hyperlink{http__response_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ HTTP\_RESPONSE\_hpp}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ HTTP\_RESPONSE\_hpp}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <sstream>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <unistd.h>}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ <stdint.h>}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00009\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{slice_8hpp}{slice.hpp}}"{}}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{keyword}{enum}\ \mbox{\hyperlink{http__response_8hpp_a8e6b9e0ae2ed953380580061420c51e7}{HttpResponseState}}}
\DoxyCodeLine{00012\ \{}
\DoxyCodeLine{00013\ \ \ \ \ \mbox{\hyperlink{http__response_8hpp_a8e6b9e0ae2ed953380580061420c51e7a9ac60e66a33df51fbe7672dbc96f6d9d}{HTTP\_RESPONSE\_UNINITIALIZED}},}
\DoxyCodeLine{00014\ \ \ \ \ \mbox{\hyperlink{http__response_8hpp_a8e6b9e0ae2ed953380580061420c51e7a57e2c30a4259d01f9c24543cdaef3dbd}{HTTP\_RESPONSE\_INITIALIZED}},}
\DoxyCodeLine{00015\ \ \ \ \ \mbox{\hyperlink{http__response_8hpp_a8e6b9e0ae2ed953380580061420c51e7acd6d0d8db2e33a3373849ebb735f5acf}{HTTP\_RESPONSE\_FINALIZED}}}
\DoxyCodeLine{00016\ \};}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{class\ }\mbox{\hyperlink{classHttpResponse}{HttpResponse}}}
\DoxyCodeLine{00019\ \{}
\DoxyCodeLine{00020\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{comment}{/*\ Constructs\ an\ uninitialized\ HTTP\ response\ */}}
\DoxyCodeLine{00022\ \ \ \ \ \mbox{\hyperlink{classHttpResponse_ab2e6cd363b5ea437643017766f882066}{HttpResponse}}();}
\DoxyCodeLine{00023\ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{comment}{/*\ Releases\ the\ response's\ resources\ */}}
\DoxyCodeLine{00025\ \ \ \ \ \mbox{\hyperlink{classHttpResponse_a7dc8102dcf63b07b9bf3c3dfed468857}{\string~HttpResponse}}();}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{comment}{/*\ Initialize\ the\ response\ class\ with\ body\ */}}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHttpResponse_a88fd98828ea717b196de7944c09c7fdf}{initialize}}(\textcolor{keywordtype}{int}\ statusCode,\ \mbox{\hyperlink{classSlice}{Slice}}\ statusMessage,\ \textcolor{keyword}{const}\ std::string\ \&body);}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{comment}{/*\ Initialize\ the\ response\ class\ with\ bodyBuffer\ for\ cgi\ pages\ */}}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHttpResponse_a88fd98828ea717b196de7944c09c7fdf}{initialize}}(\textcolor{keywordtype}{int}\ statusCode,\ \mbox{\hyperlink{classSlice}{Slice}}\ statusMessage,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{void}\ *bodyBuffer,\ \textcolor{keywordtype}{size\_t}\ bodySize);}
\DoxyCodeLine{00032\ \ \ \ \ }
\DoxyCodeLine{00033\ \ \ \ \ \textcolor{comment}{/*\ Initialize\ the\ response\ class\ with\ bodyFileno\ for\ static\ pages\ */}}
\DoxyCodeLine{00034\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHttpResponse_a88fd98828ea717b196de7944c09c7fdf}{initialize}}(\textcolor{keywordtype}{int}\ statusCode,\ \mbox{\hyperlink{classSlice}{Slice}}\ statusMessage,\ \textcolor{keywordtype}{int}\ bodyFileno,\ \textcolor{keywordtype}{size\_t}\ bodySize);}
\DoxyCodeLine{00035\ \ \ \ \ }
\DoxyCodeLine{00036\ \ \ \ \ \textcolor{comment}{/*\ Add\ a\ header\ field\ to\ the\ header\ response\ */}}
\DoxyCodeLine{00037\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHttpResponse_ae9e60787d23035de57928eb1340fe69b}{addHeader}}(\mbox{\hyperlink{classSlice}{Slice}}\ key,\ \mbox{\hyperlink{classSlice}{Slice}}\ value);}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{comment}{/*\ Finalize\ Header\ */}}
\DoxyCodeLine{00040\ \ \ \ \ uint64\_t\ \mbox{\hyperlink{classHttpResponse_acc815b9b5c1ec533085fd019ef77b606}{finalizeHeader}}();}
\DoxyCodeLine{00041\ \ \ \ \ }
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{comment}{/*\ Check\ if\ the\ response\ has\ data\ to\ send\ */}}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classHttpResponse_a5799dc9da19cbcb19469f499cfc9a806}{hasData}}();}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{/*\ Start\ transfer\ process\ of\ the\ response\ to\ the\ socket\ */}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{classHttpResponse_a804dfc806ec3ca7f64aecbc0e4e7883c}{transferToSocket}}(\textcolor{keywordtype}{int}\ fileno);}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{/*\ Gets\ the\ response's\ current\ state\ */}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keyword}{inline}\ \mbox{\hyperlink{http__response_8hpp_a8e6b9e0ae2ed953380580061420c51e7}{HttpResponseState}}\ \mbox{\hyperlink{classHttpResponse_ae50b58679d57c153588c3d93385b6ccf}{getState}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00050\ \textcolor{keyword}{\ \ \ \ }\{}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \_state;}
\DoxyCodeLine{00052\ \ \ \ \ \}}
\DoxyCodeLine{00053\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00054\ \ \ \ \ \mbox{\hyperlink{http__response_8hpp_a8e6b9e0ae2ed953380580061420c51e7}{HttpResponseState}}\ \_state;}
\DoxyCodeLine{00055\ \ \ \ \ std::stringstream\ \_headerStream;}
\DoxyCodeLine{00056\ \ \ \ \ std::string\ \ \ \ \ \ \ \_headerString;}
\DoxyCodeLine{00057\ \ \ \ \ std::string\ \ \ \ \ \ \ \_bodyBuffer;}
\DoxyCodeLine{00058\ \ \ \ \ \mbox{\hyperlink{classSlice}{Slice}}\ \ \ \ \ \ \ \ \ \ \ \ \ \_headerSlice;}
\DoxyCodeLine{00059\ \ \ \ \ \mbox{\hyperlink{classSlice}{Slice}}\ \ \ \ \ \ \ \ \ \ \ \ \ \_bodySlice;}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keywordtype}{int}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_bodyFileno;}
\DoxyCodeLine{00061\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \ \ \ \ \ \ \ \ \ \ \ \_bodyRemainder;}
\DoxyCodeLine{00062\ \ \ \ \ \textcolor{keywordtype}{char}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \_readBuffer[8192];}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{comment}{/*\ Initializes\ the\ header\ string\ stream\ with\ a\ response\ line\ */}}
\DoxyCodeLine{00065\ \ \ \ \ \textcolor{keywordtype}{void}\ initializeHeader(\textcolor{keywordtype}{int}\ statusCode,\ \mbox{\hyperlink{classSlice}{Slice}}\ statusMessage,\ \textcolor{keywordtype}{size\_t}\ bodySize);}
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \ \ \ \ \textcolor{comment}{/*\ Attempts\ to\ send\ as\ many\ bytes\ as\ possible\ from\ a\ slice\ to\ a\ socket,}}
\DoxyCodeLine{00068\ \textcolor{comment}{\ \ \ \ \ \ \ only\ consumes\ the\ bytes\ that\ were\ actually\ sent\ */}}
\DoxyCodeLine{00069\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ sendSliceToSocket(\textcolor{keywordtype}{int}\ fileno,\ \mbox{\hyperlink{classSlice}{Slice}}\ \&slice);}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{comment}{/*\ Buffers\ and\ streams\ bytes\ out\ of\ \`{}\_bodyFileno`\ to\ the\ given\ socket\ */}}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ streamFileToSocket(\textcolor{keywordtype}{int}\ fileno);}
\DoxyCodeLine{00073\ \};}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ HTTP\_RESPONSE\_hpp}}

\end{DoxyCode}
